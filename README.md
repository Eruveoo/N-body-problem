# N-Body Simulation Project

This project simulates the gravitational interactions between multiple celestial bodies using Python. It consists of two main modules: `n_body_problem.py` for running simulations and generating data, and `create_animation.py` for visualizing the results as animations.
Please look first into the directory example_outputs, where are some output files (plots af trajectories of the bodies, time dependance of their kinetic and potential energies and also video file with the animation) corresponding to initial conditions in folder initial_conditions.

## Installation

To run the scripts, ensure you have Python installed, along with the necessary libraries. Hereâ€™s how to set it up:

1. **Python Installation**: Ensure Python 3.6 or higher is installed on your system.
2. **Dependencies Installation**: Install the required Python libraries from requirements.txt.

## Modules

### 1. `n_body_problem.py`

This is the main module of the project, used to simulate n-body gravitational interactions. The simulation parameters can be customized via command line options.

#### Usage

Run the simulation using the following command:

```
python n_body_problem.py <csv_filepath> [OPTIONS]
```

**Arguments:**

- `csv_filepath`: Path to the CSV file containing initial conditions for the bodies.

You can try to run this module on the prepared initial conditions in the initial_conditions directory to see how it works. Then you can try to create a new initial condition either as modification of one of those in the directory or totally new.
Just be careful, it's not that easy to come up with good initial conditions that will result in some nice stable system. It takes a lot of changing of the parameters. Very often it happens that the bodies just fly away to infinity. 

**Options:**

- `--dimensions`: Number of spatial dimensions of the simulation (2 or 3).
- `--final_time`: Duration of the simulation in simulation units.
- `--time_increment`: Time step size for updating the simulation.
- `--plot_trajectories`: Optional, comma-separated list of body indices to plot trajectories. Plots all if omitted.
- `--plot_energies`: Optional, comma-separated list of body indices to plot energies. Plots all if omitted.
- `--solver`: Numerical method for the simulation ('euler' or 'leap_frog'). Default is 'leap_frog'.
- `--generate-output-file`: Generates an output CSV file with detailed simulation data if set.

You can pass these options in the CLI command or you can change them directly in the n_body_system.py file

### 2. `create_animation.py`

This module creates animations from the simulation data stored in a CSV file generated by the n_body_problem.py.
This module creates the video animation of the n body problem. To run it you first need to run n_body_problem.py with --generate-output-file option to create a csv file with the data of the history of the bodies positions. These files are not included, because they can be quite large.

#### Usage

Generate an animation using the following command:

python n_body_problem.py <csv_filepath> [OPTIONS]




**Arguments:**

- `csv_file_path`: Path to the CSV file containing the simulation data.

**Options:**

- `--num_dimensions`: Number of dimensions (2 or 3) of the simulation.
- `--duration`: Total duration of the animation in seconds. Default is 30.
- `--trail_length`: Number of frames to show the trail behind each body. Default is 100.
- `--with_projections`: Plot the projections on the coordinate planes in a 3D simulation. Default is True.

## Examples

Here are some examples of how to use the command line interfaces for both modules:

- **Running a simulation**:

```
python n_body_problem.py "path/to/initial_conditions.csv" --dimensions 3 --final_time 5000 --time_increment 0.05 --solver leap_frog
```

- **Creating an animation**:

```
python create_animation.py "path/to/output_data.csv" --num_dimensions 3 --duration 60 --trail_length 50
```

## Running Tests

You can run the tests provided. Make sure you have pytest installed:

```
pip install pytest pytest-mock
```

Then, run the tests using the following commands:

- **Testing n_body_problem.py**:

```
pytest test_n_body_problem.py
```

- **Testing create_animation.py**:

```
pytest test_create_animation.py
```
These commands will execute the tests and provide you with a summary of the results.

